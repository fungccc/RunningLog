<div class="controls">
    <div class="filters">
        <input type="month" v-model="filters.month">
        <select v-model="filters.type">
            <option value="all">å…¨éƒ¨é¡å‹</option>
            <option value="race">æ¯”è³½</option>
            <option value="training">è¨“ç·´</option>
        </select>
    </div>
    <div class="actions">
        <button @click="openModal('training')" class="btn secondary">æ–°å¢è¨“ç·´</button>
        <button @click="openModal('race')" class="btn primary">æ–°å¢æ¯”è³½</button>
        <button @click="exportCSV" class="btn outline">åŒ¯å‡º</button>
        
        <label class="btn outline file-btn" style="border: 1px dashed #666; cursor: pointer;">
            ğŸ“‚ åŒ¯å…¥ CSV (Garmin/èˆŠç´€éŒ„)
            <input type="file" @change="handleImport" accept=".csv" hidden>
        </label>
    </div>
</div>

<div class="activity-list">
    <div v-for="act in filteredActivities" :key="act.id" class="card activity-card" :class="act.type">
        <div class="act-header">
            <div class="act-title-group">
                <span class="date">{{ act.date }}</span>
                <span class="badge" :class="act.type">
                    {{ act.type === 'race' ? (act.raceNameZh || act.raceName) : act.workoutTitle }}
                </span>
            </div>
            <button @click="editActivity(act)" class="btn sm outline" style="padding: 2px 8px; font-size: 0.8rem;">âœï¸ ç·¨è¼¯</button>
        </div>
        
        <div class="act-meta">
             <span v-if="act.distanceKm" style="font-weight:bold; color:#2563eb; margin-right:10px;">{{ act.distanceKm }} km</span>
             <span v-if="act.durationSec" style="color:#64748b;">â± {{ formatDuration(act.durationSec) }}</span>
        </div>

        <div class="act-details">
            <p v-if="act.locationName">ğŸ“ {{ act.locationName }}</p>
            <p v-if="act.note" class="note" style="white-space: pre-wrap;">{{ act.note }}</p>
            <div v-if="act.type === 'training' && act.workoutCategories" class="tags">
                <span v-for="tag in act.workoutCategories" class="tag">{{ tag }}</span>
            </div>
        </div>
    </div>
</div>
